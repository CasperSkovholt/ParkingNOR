<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Parking Reservation System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            color: #333;
            margin: 0;
            padding: 0;
        }

        header {
            background-color: #000;
            color: white;
            padding: 15px;
            text-align: center;
        }

        #search {
            text-align: center;
            padding: 20px;
        }

        #search-bar {
            padding: 10px;
            width: 300px;
            font-size: 16px;
        }

        #search-button {
            padding: 10px;
            font-size: 16px;
            background-color: #000;
            color: white;
            border: none;
            cursor: pointer;
        }

        #map-container {
            height: 400px;
            background-color: #ccc; /* Placeholder for map */
            margin: 20px;
        }

        #parking-list {
            padding: 20px;
            background-color: white;
            margin: 20px;
        }

        #parking-spots {
            list-style-type: none;
            padding: 0;
        }

        #parking-spots li {
            padding: 10px;
            background: #f9f9f9;
            margin-bottom: 10px;
            border: 1px solid #ddd;
        }

        .reservation {
            margin: 20px;
            padding: 20px;
            background-color: #fff;
            border: 1px solid #ddd;
        }

        .error-message {
            color: red;
        }

        .success-message {
            color: green;
        }
    </style>
</head>
<body>
    <header>
        <h1>Majorstuen Smart Parking Reservation System</h1>
    </header>
    <main>
        <section id="search">
            <input type="text" id="search-bar" placeholder="Search for parking...">
            <button id="search-button">Search</button>
        </section>
        <section id="map">
            <div id="map-container">Map goes here (integrate with Google Maps API)</div>
        </section>
        <section id="parking-list">
            <h2>Available Parking Spots</h2>
            <ul id="parking-spots">
                <!-- List of parking spots will be dynamically populated here -->
            </ul>
        </section>
        <section id="user-reservations">
            <h2>Your Reservations</h2>
            <ul id="reservations-list">
                <!-- List of user reservations will be dynamically populated here -->
            </ul>
        </section>
    </main>
    <script>
        const reservations = [];

        document.getElementById('search-button').addEventListener('click', function() {
            const searchTerm = document.getElementById('search-bar').value.toLowerCase();
            // Call a function to get parking spots based on the search term
            fetchParkingSpots(searchTerm);
        });

        function fetchParkingSpots(location) {
    if (location !== 'majorstuen') {
        displayMessage('error', 'No parking spots found for the given location.');
        return;
    }
            // Mock function to simulate fetching data
            const spots = [
                { id: 1, name: 'Parking Spot A', availability: 'Available' },
                { id: 2, name: 'Parking Spot B', availability: 'Occupied' },
                { id: 3, name: 'Parking Spot C', availability: 'Available' },
                { id: 4, name: 'Parking Spot D', availability: 'Available' },
                { id: 5, name: 'HC Parking Spot 1 (Requires evidence paper in front window)', availability: 'Available', hc: true },
                { id: 6, name: 'HC Parking Spot 2 (Requires evidence paper in front window)', availability: 'Available', hc: true }
            ];

            const parkingSpotsContainer = document.getElementById('parking-spots');
            parkingSpotsContainer.innerHTML = '';

            spots.forEach(spot => {
                const spotElement = document.createElement('li');
                spotElement.textContent = `${spot.name} - ${spot.availability}`;
                if (spot.hc) {
                    spotElement.textContent += ' (Requires evidence paper in front window)';
                }
                if (spot.availability === 'Available') {
                    const reserveButton = document.createElement('button');
                    reserveButton.textContent = 'Reserve';
                    reserveButton.addEventListener('click', function() {
                        reserveParkingSpot(spot);
                    });
                    spotElement.appendChild(reserveButton);
                }
                parkingSpotsContainer.appendChild(spotElement);
            });
        }

        function reserveParkingSpot(spot) {
            if (spot.hc) {
                alert('Note: You must have an evidence paper displayed in the front window when parking in an HC spot.');
            }
            if (reservations.some(reservation => reservation.id === spot.id)) {
                displayMessage('error', 'This spot is already reserved by you.');
                return;
            }

            reservations.push(spot);
            displayMessage('success', `Parking Spot ${spot.id} reserved!`);
            updateReservationsList();
        }

        function updateReservationsList() {
            const reservationsContainer = document.getElementById('reservations-list');
            reservationsContainer.innerHTML = '';

            reservations.forEach(reservation => {
                const reservationElement = document.createElement('li');
                reservationElement.textContent = `${reservation.name}`;
                const cancelButton = document.createElement('button');
                cancelButton.textContent = 'Cancel';
                cancelButton.addEventListener('click', function() {
                    cancelReservation(reservation);
                });
                reservationElement.appendChild(cancelButton);
                reservationsContainer.appendChild(reservationElement);
            });
        }

        function cancelReservation(reservation) {
            const index = reservations.findIndex(r => r.id === reservation.id);
            if (index > -1) {
                reservations.splice(index, 1);
                displayMessage('success', `Reservation for Parking Spot ${reservation.id} cancelled.`);
                updateReservationsList();
            }
        }

        function displayMessage(type, message) {
            const messageElement = document.createElement('p');
            messageElement.className = type === 'error' ? 'error-message' : 'success-message';
            messageElement.textContent = message;
            document.body.insertBefore(messageElement, document.body.firstChild);

            setTimeout(() => {
                messageElement.remove();
            }, 3000);
        }
    </script>
</body>
</html>
